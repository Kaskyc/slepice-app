<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evidence chovu slepic</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #446A1C;
            --primary-light: #C3F28B;
            --primary-dark: #305000;
            --secondary-color: #57624A;
            --secondary-light: #DBE7C8;
            --secondary-dark: #141E0C;
            --background-color: #FDFDF5;
            --surface-color: #FFFFFF;
            --error-color: #BA1A1A;
            --success-color: #0D6E00;
            --text-color: #1A1C18;
            --text-secondary: #44483E;
            --border-color: #E0E4D6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .search-box {
            position: relative;
            width: 300px;
        }

        .search-box input {
            width: 100%;
            padding: 10px 10px 10px 35px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            font-size: 0.9rem;
        }

        .search-box i {
            position: absolute;
            left: 10px;
            top: 12px;
            color: var(--text-secondary);
        }

        .btn {
            padding: 10px 16px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--secondary-light);
            color: var(--secondary-dark);
        }

        .btn-secondary:hover {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--error-color);
            color: white;
        }

        .btn-danger:hover {
            opacity: 0.9;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .stat-card {
            background-color: var(--surface-color);
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .stat-card h3 {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .stat-card .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .stat-card .stat-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .table-container {
            background-color: var(--surface-color);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background-color: var(--secondary-light);
            color: var(--secondary-dark);
            text-align: left;
            padding: 12px 16px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        tbody tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-active {
            background-color: #E8F5E9;
            color: var(--success-color);
        }

        .status-deceased {
            background-color: #EEEEEE;
            color: #616161;
        }

        .color-badge {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 6px;
        }

        .actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .icon-btn:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .icon-btn i {
            font-size: 0.9rem;
        }

        .edit-btn {
            color: #1976D2;
        }

        .delete-btn {
            color: var(--error-color);
        }

        /* Modal */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .modal-backdrop.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: var(--surface-color);
            border-radius: 8px;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transform: translateY(20px);
            transition: transform 0.3s;
        }

        .modal-backdrop.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .modal-body {
            padding: 24px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 16px 24px;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            border-top: 1px solid var(--border-color);
        }

        /* Form */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            font-size: 0.9rem;
            transition: border-color 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-control.error {
            border-color: var(--error-color);
        }

        .form-error {
            color: var(--error-color);
            font-size: 0.8rem;
            margin-top: 4px;
        }

        .required:after {
            content: " *";
            color: var(--error-color);
        }

        .form-help {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 16px;
        }

        /* Delete Confirmation */
        .confirm-delete {
            max-width: 400px;
        }

        .confirm-delete .modal-body {
            text-align: center;
            padding: 24px;
        }

        .confirm-delete i {
            font-size: 3rem;
            color: var(--error-color);
            margin-bottom: 16px;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .container {
                padding: 16px;
            }

            .stats-cards {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
        }

        @media (max-width: 768px) {
            header {
                padding: 16px;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
                gap: 16px;
            }

            .search-box {
                width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            table {
                min-width: 700px;
            }
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--text-secondary);
            opacity: 0.3;
            margin-bottom: 16px;
        }

        .empty-state p {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        /* Date inputs for Firefox */
        input[type="date"] {
            min-height: 38px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Evidence chovu slepic</h1>
    </header>

    <div class="container">
        <div class="controls">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="Vyhledat slepici...">
            </div>
            <button class="btn btn-primary" id="add-slepice-btn">
                <i class="fas fa-plus"></i> Přidat slepici
            </button>
        </div>

        <div class="stats-cards">
            <div class="stat-card">
                <h3>Celkem slepic</h3>
                <div class="stat-value" id="stat-total">0</div>
                <div class="stat-description">Aktivních záznamů</div>
            </div>
            <div class="stat-card">
                <h3>Celková investice</h3>
                <div class="stat-value" id="stat-investment">0 Kč</div>
                <div class="stat-description">Pořizovací cena všech slepic</div>
            </div>
            <div class="stat-card">
                <h3>Historické záznamy</h3>
                <div class="stat-value" id="stat-historical">0</div>
                <div class="stat-description">Ukončených záznamů</div>
            </div>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Druh</th>
                        <th>Zakoupení</th>
                        <th>Stáří</th>
                        <th>Kroužek</th>
                        <th>Cena</th>
                        <th>Akce</th>
                    </tr>
                </thead>
                <tbody id="slepice-table-body">
                    <!-- Záznamy budou dynamicky vloženy pomocí JS -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal pro přidání/editaci slepice -->
    <div class="modal-backdrop" id="slepice-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Přidat novou slepici</h2>
                <button class="modal-close" id="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="slepice-form">
                    <input type="hidden" id="slepice-id">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="druh" class="required">Druh slepice</label>
                            <input type="text" id="druh" class="form-control" required>
                            <div class="form-error" id="druh-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="datumZakoupeni" class="required">Datum zakoupení</label>
                            <input type="date" id="datumZakoupeni" class="form-control" required>
                            <div class="form-error" id="datumZakoupeni-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="stariPriZakoupeni" class="required">Stáří při zakoupení (týdny)</label>
                            <input type="number" id="stariPriZakoupeni" class="form-control" min="0" required>
                            <div class="form-error" id="stariPriZakoupeni-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="datumUmrti">Datum úmrtí</label>
                            <input type="date" id="datumUmrti" class="form-control">
                            <div class="form-error" id="datumUmrti-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="stariPriUmrti">Stáří při úmrtí (týdny)</label>
                            <input type="number" id="stariPriUmrti" class="form-control" min="0">
                            <div class="form-error" id="stariPriUmrti-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="barvaKrouzku">Barva kroužku</label>
                            <select id="barvaKrouzku" class="form-control">
                                <option value="">Vyberte barvu</option>
                                <option value="červená">Červená</option>
                                <option value="zelená">Zelená</option>
                                <option value="žlutá">Žlutá</option>
                                <option value="modrá">Modrá</option>
                            </select>
                            <div class="form-error" id="barvaKrouzku-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="cisloKrouzku">Číslo kroužku</label>
                            <input type="text" id="cisloKrouzku" class="form-control">
                            <div class="form-error" id="cisloKrouzku-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="porizovaci_cena">Pořizovací cena (Kč)</label>
                            <input type="number" id="porizovaci_cena" class="form-control" min="0">
                            <div class="form-error" id="porizovaci_cena-error"></div>
                        </div>
                    </div>
                    <div class="form-help">* Povinné pole</div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="modal-cancel">Zrušit</button>
                <button type="button" class="btn btn-primary" id="modal-save">Uložit</button>
            </div>
        </div>
    </div>

    <!-- Modal pro potvrzení smazání -->
    <div class="modal-backdrop" id="delete-modal">
        <div class="modal confirm-delete">
            <div class="modal-header">
                <h2 class="modal-title">Odstranit záznam</h2>
                <button class="modal-close" id="delete-modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Opravdu chcete odstranit tento záznam?</p>
                <p id="delete-slepice-name"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="delete-cancel">Zrušit</button>
                <button type="button" class="btn btn-danger" id="delete-confirm">Odstranit</button>
            </div>
        </div>
    </div>

    <script>
        // Počáteční data
        let slepice = [
            { 
                id: 1, 
                druh: "Leghornka bílá", 
                datumZakoupeni: "2025-01-15", 
                stariPriZakoupeni: 12, 
                datumUmrti: "", 
                stariPriUmrti: null, 
                barvaKrouzku: "červená", 
                cisloKrouzku: "A123", 
                porizovaci_cena: 250 
            },
            { 
                id: 2, 
                druh: "Vlaška", 
                datumZakoupeni: "2024-11-03", 
                stariPriZakoupeni: 20, 
                datumUmrti: "", 
                stariPriUmrti: null, 
                barvaKrouzku: "modrá", 
                cisloKrouzku: "B456", 
                porizovaci_cena: 290 
            },
            { 
                id: 3, 
                druh: "Hempšírka", 
                datumZakoupeni: "2024-09-20", 
                stariPriZakoupeni: 16, 
                datumUmrti: "2025-03-15", 
                stariPriUmrti: 28, 
                barvaKrouzku: "zelená", 
                cisloKrouzku: "C789", 
                porizovaci_cena: 320 
            }
        ];

        // HTML elementy
        const slepiceTableBody = document.getElementById('slepice-table-body');
        const searchInput = document.getElementById('search-input');
        const addSlepiceBtn = document.getElementById('add-slepice-btn');
        
        const slepiceModal = document.getElementById('slepice-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalClose = document.getElementById('modal-close');
        const modalCancel = document.getElementById('modal-cancel');
        const modalSave = document.getElementById('modal-save');
        
        const slepiceForm = document.getElementById('slepice-form');
        const slepiceIdInput = document.getElementById('slepice-id');
        
        const deleteModal = document.getElementById('delete-modal');
        const deleteModalClose = document.getElementById('delete-modal-close');
        const deleteCancel = document.getElementById('delete-cancel');
        const deleteConfirm = document.getElementById('delete-confirm');
        const deleteSlepiceName = document.getElementById('delete-slepice-name');
        
        const statTotal = document.getElementById('stat-total');
        const statInvestment = document.getElementById('stat-investment');
        const statHistorical = document.getElementById('stat-historical');
        
        // Formátování data
        function formatDate(dateString) {
            if (!dateString) return "-";
            const date = new Date(dateString);
            return date.toLocaleDateString('cs-CZ');
        }
        
        // Zobrazení tabulky slepic
        function renderSlepiceTable(data) {
            slepiceTableBody.innerHTML = '';
            
            if (data.length === 0) {
                slepiceTableBody.innerHTML = `
                    <tr>
                        <td colspan="6">
                            <div class="empty-state">
                                <i class="fas fa-feather"></i>
                                <p>Zatím nemáte žádné záznamy</p>
                                <button class="btn btn-primary" id="empty-add-btn">
                                    <i class="fas fa-plus"></i> Přidat první slepici
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
                
                document.getElementById('empty-add-btn').addEventListener('click', openAddModal);
                return;
            }
            
            data.forEach(slepice => {
                const row = document.createElement('tr');
                
                // Barva kroužku
                let colorStyle = '';
                if (slepice.barvaKrouzku) {
                    const color = getColorCode(slepice.barvaKrouzku);
                    colorStyle = `<span class="color-badge" style="background-color: ${color}"></span>`;
                }
                
                // Status
                const statusHtml = slepice.datumUmrti 
                    ? `<span class="status status-deceased">Zemřela</span>` 
                    : `<span class="status status-active">Žije</span>`;
                
                row.innerHTML = `
                    <td>${slepice.druh}</td>
                    <td>
                        ${formatDate(slepice.datumZakoupeni)}
                        <div style="font-size: 0.8rem; color: #666;">${slepice.stariPriZakoupeni} týdnů</div>
                    </td>
                    <td>
                        ${slepice.datumUmrti 
                            ? `${formatDate(slepice.datumUmrti)}<div style="font-size: 0.8rem; color: #666;">${slepice.stariPriUmrti} týdnů</div>` 
                            : statusHtml
                        }
                    </td>
                    <td>${colorStyle}${slepice.cisloKrouzku || "-"}</td>
                    <td>${slepice.porizovaci_cena ? `${slepice.porizovaci_cena} Kč` : "-"}</td>
                    <td class="actions">
                        <button class="icon-btn edit-btn" data-id="${slepice.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="icon-btn delete-btn" data-id="${slepice.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                slepiceTableBody.appendChild(row);
            });
            
            // Nastavení event listenerů pro tlačítka
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', () => openEditModal(parseInt(btn.dataset.id)));
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', () => openDeleteModal(parseInt(btn.dataset.id)));
            });
        }
        
        // Získání kódu barvy
        function getColorCode(barva) {
            switch (barva) {
                case 'červená': return '#E53935';
                case 'zelená': return '#43A047';
                case 'žlutá': return '#FDD835';
                case 'modrá': return '#1E88E5';
                default: return '#9E9E9E';
            }
        }
        
        // Aktualizace statistik
        function updateStats() {
            const activeSlepice = slepice.filter(s => !s.datumUmrti);
            const historicalSlepice = slepice.filter(s => s.datumUmrti);
            const totalInvestment = slepice.reduce((sum, s) => sum + (s.porizovaci_cena || 0), 0);
            
            statTotal.textContent = activeSlepice.length;
            statInvestment.textContent = `${totalInvestment} Kč`;
            statHistorical.textContent = historicalSlepice.length;
        }
        
        // Vyhledávání
        function searchSlepice(query) {
            if (!query) {
                return slepice;
            }
            
            query = query.toLowerCase();
            return slepice.filter(s => 
                s.druh.toLowerCase().includes(query) ||
                (s.cisloKrouzku && s.cisloKrouzku.toLowerCase().includes(query)) ||
                (s.barvaKrouzku && s.barvaKrouzku.toLowerCase().includes(query))
            );
        }
        
        // Otevření modálního okna pro přidání
        function openAddModal() {
            modalTitle.textContent = 'Přidat novou slepici';
            slepiceForm.reset();
            slepiceIdInput.value = '';
            slepiceModal.classList.add('active');
        }
        
        // Otevření modálního okna pro editaci
        function openEditModal(id) {
            const slepiceToEdit = slepice.find(s => s.id === id);
            if (!slepiceToEdit) return;
            
            modalTitle.textContent = 'Upravit záznam';
            
            // Nastavení hodnot formuláře
            slepiceIdInput.value = slepiceToEdit.id;
            document.getElementById('druh').value = slepiceToEdit.druh;
            document.getElementById('datumZakoupeni').value = slepiceToEdit.datumZakoupeni;
            document.getElementById('stariPriZakoupeni').value = slepiceToEdit.stariPriZakoupeni;
            document.getElementById('datumUmrti').value = slepiceToEdit.datumUmrti || '';
            document.getElementById('stariPriUmrti').value = slepiceToEdit.stariPriUmrti || '';
            document.getElementById('barvaKrouzku').value = slepiceToEdit.barvaKrouzku || '';
            document.getElementById('cisloKrouzku').value = slepiceToEdit.cisloKrouzku || '';
            document.getElementById('porizovaci_cena').value = slepiceToEdit.porizovaci_cena || '';
            
            slepiceModal.classList.add('active');
        }
        
        // Otevření modálního okna pro potvrzení smazání
        function openDeleteModal(id) {
            const slepiceToDelete = slepice.find(s => s.id === id);
            if (!slepiceToDelete) return;
            
            deleteSlepiceName.textContent = `"${slepiceToDelete.druh}" (${slepiceToDelete.cisloKrouzku || 'bez kroužku'})`;
            deleteConfirm.dataset.id = id;
            
            deleteModal.classList.add('active');
        }
        
        // Zavření modálního okna
        function closeModal(modal) {
            modal.classList.remove('active');
            
            // Odstranění chybových hlášek
            document.querySelectorAll('.form-error').forEach(el => {
                el.textContent = '';
            });
            
            document.querySelectorAll('.form-control').forEach(el => {
                el.classList.remove('error');
            });
        }
        
        // Validace formuláře
        function validateForm() {
            let isValid = true;
            
            // Povinná pole
            const requiredFields = [
                { id: 'druh', message: 'Zadejte druh slepice' },
                { id: 'datumZakoupeni
